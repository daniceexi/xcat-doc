<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#basic-thought">Basic Thought</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#other-design-considerations">Other Design Considerations</a></li>
</ul>
</div>
<p><!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> Table of Contents</p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#basic-thought">Basic Thought</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#other-design-considerations">Other Design Considerations</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->


<h2 id="overview"><a href="#TOC">Overview</a></h2>
<p>Based on the pre-defined groups in template, it will be much convenient to automatically match the machine type of node to those groups.</p>
<h2 id="basic-thought"><a href="#TOC">Basic Thought</a></h2>
<p>1. Add a file ibmhwtypes.pm storing the machine type(mt) and corresponding group under $xCAT/lib/perl/xCAT/data/, export a global hash with the key is machine type and value is pre-defined group.</p>
<p>2. After the machine type is gotten, match the type to the global hash and obtain the corresponding group, then append the group to groups attribute of the specified node.</p>
<h2 id="implementation"><a href="#TOC">Implementation</a></h2>
<p>1. The file ibmhwtypes.pm will include two main part:</p>
<p>Part1. The hash table groups2mtm is used to store the matching of groups and related MTs. It is like this:</p>
<pre><code>   my %groups2mtm = (    
   &quot;x3250&quot; =&amp;gt; [&quot;2583&quot;,&quot;4251&quot;,&quot;4252&quot;],
   &quot;x3550&quot; =&amp;gt; [&quot;7914&quot;,&quot;7944&quot;,&quot;7946&quot;],
   &quot;x3650&quot; =&amp;gt; [&quot;7915&quot;,&quot;7945&quot;],
   &quot;dx360&quot; =&amp;gt; [],
   &quot;x220&quot;  =&amp;gt; [&quot;7906&quot;],
   &quot;x240&quot;  =&amp;gt; [&quot;8737&quot;,&quot;7863&quot;],
   &quot;x440&quot;  =&amp;gt; [&quot;7917&quot;],
   &quot;p260&quot;  =&amp;gt; [&quot;7895&quot;], #789522X, 789523X
   &quot;p460&quot;  =&amp;gt; [],       #789542X
   &quot;p470&quot;  =&amp;gt; [&quot;7954&quot;],
   );</code></pre>
<p>Part2. The subroutine parse_group is used to return group for the given MT.</p>
<p>Note: for MT 7895, the 789522X and 789523X are belong to p260, 789542X is belong to p460. It is dealt in this subroutine.</p>
<p>The admin can add new (group, mt) pair or append a new mt for a specified group in groups2mtm.</p>
<p>Since there is many model(The last 3 characters of MTM) for the same machine Type(The first 4 characters of MTM), the machine Type is used as the key to find group.</p>
<p>2. For xCAT commands.</p>
<p>After mtm is gotten when doing node discovery or definitionu pdating(lsslp, rscan, or genesis findme process) or checking node information(rinv), collect the machine Type(The first 4 characters of MTM) and use ibmhwtypes::parse_group to get the proper group.</p>
<p>For rinv, there is an option '-t ' is added to specify that we need to update the groups attribute of the node with pre-defined groups.</p>
<p>At last, append the proper group to the groups attribute of the specified node.</p>
<h2 id="other-design-considerations"><a href="#TOC">Other Design Considerations</a></h2>
<ul>
<li><strong>Required reviewers</strong>: Bruce Potter, Guang Cheng</li>
<li><strong>Required approvers</strong>: Bruce Potter</li>
<li><strong>Database schema changes</strong>: N/A</li>
<li><strong>Affect on other components</strong>: N/A</li>
<li><strong>External interface changes, documentation, and usability issues</strong>: N/A</li>
<li><strong>Packaging, installation, dependencies</strong>: N/A</li>
<li><strong>Portability and platforms (HW/SW) supported</strong>: N/A</li>
<li><strong>Performance and scaling considerations</strong>: N/A</li>
<li><strong>Migration and coexistence</strong>: N/A</li>
<li><strong>Serviceability</strong>: N/A</li>
<li><strong>Security</strong>: N/A</li>
<li><strong>NLS and accessibility</strong>: N/A</li>
<li><strong>Invention protection</strong>: N/A</li>
</ul>
</body>
</html>
