<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#step-1">Step 1</a></li>
<li><a href="#step-2">Step 2</a></li>
<li><a href="#step-3">Step 3</a></li>
<li><a href="#step-4">Step 4</a></li>
<li><a href="#step-5">Step 5</a></li>
<li><a href="#notes-from-sles-10">Notes from SLES 10</a><ul>
<li><a href="#stateless">Stateless</a></li>
</ul></li>
</ul>
</div>
<p><!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> Table of Contents</p>
<ul>
<li><a href="#step-1">Step 1</a></li>
<li><a href="#step-2">Step 2</a></li>
<li><a href="#step-3">Step 3</a></li>
<li><a href="#step-4">Step 4</a></li>
<li><a href="#step-5">Step 5</a></li>
<li><a href="#notes-from-sles-10">Notes from SLES 10</a></li>
<li><a href="#stateless">Stateless</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<p><a href="Howto_Warning">Howto_Warning</a></p>
<p><strong>Note: Refer to [XCAT_iDataPlex_Cluster_Quick_Start] for a more up to date quick start guide.</strong></p>
<h2 id="step-1"><a href="#TOC">Step 1</a></h2>
<p>Install base OS, nothing special except:</p>
<ul>
<li>Turn off firewall unless you want to go through the hassle of configuring it. (Most of our sites are well protected already)</li>
<li><p>Make a directory to install everything in</p>
<p>mkdir -p /install/packages/xcat</p></li>
<li><p>Copy the SLES 11 iso image to /install/packages - you may also need the SDK iso.</p></li>
</ul>
<h2 id="step-2"><a href="#TOC">Step 2</a></h2>
<ul>
<li>Setup /etc/hosts</li>
<li>Use YaST to add the SLES11 iso to your local repository. Zypper doesn't work for adding iso images. Use the iso image you copied to /install/packages. Run yast-&gt;software-&gt;software repositories. There, you can add the ISO(s).</li>
<li>vi /etc/sysconfig/network/ifcfg-eth(0/1) the way you want
<ul>
<li>TIP: To change the order of your ethernet interfaces change /etc/udev/30_persistant_names ... (or something like that, I'm doing this from memory...</li>
</ul></li>
</ul>
<h2 id="step-3"><a href="#TOC">Step 3</a></h2>
<p>Add the xCAT and xCAT-dep repositories for SLES</p>
<pre><code>zypper ar http://xcat.sf.net/yum/core-snap/xCAT-core.repo
zypper ar http://xcat.sf.net/yum/xcat-dep/sles11/x86_64/xCAT-dep.repo</code></pre>
<p>install xCAT</p>
<pre><code>zypper install xCAT</code></pre>
<h2 id="step-4"><a href="#TOC">Step 4</a></h2>
<p>Set up environment and services</p>
<pre><code>. /etc/profile.d/xcat.sh
tabdump site # just to check to make sure it works
chkconfig –add nfsserver; service nfsserver restart
chkconfig –add ntp; service ntp restart
# correct this xCAT BUG
cp /etc/httpd/conf.d/xcat.conf /etc/apache2/conf.d/
chkconfig –add apache2; service apache2 restart
chkconfig –add tftpd; service tftpd restart
chkconfig -add named; service named start
zypper install dhcp-server
chkconfig -add dhcpd;</code></pre>
<p>Edit the dhcp server config to use the appropritate interface:</p>
<pre><code>vi /etc/sysconfig/dhcpd
DHCPD_INTERFACE=&quot;eth1&quot;</code></pre>
<p>Starting dhcp won't work until makedhcp -n is run (after setting up tables)</p>
<h2 id="step-5"><a href="#TOC">Step 5</a></h2>
<p>Setup tables as usual (see <a href="Basic_Install_DHCP">here</a> for more info)</p>
<p>Run copycds... no changes here, just make sure the nodetype OS is set to sles11.</p>
<h1 id="notes-from-sles-10"><a href="#TOC">Notes from SLES 10</a></h1>
<h2 id="stateless"><a href="#TOC">Stateless</a></h2>
<p>If you are deploying a stateless image, genimage in /opt/xcat/share/xcat/netboot/sles does not work because zypper is buggy. (Its fixed in SP2)</p>
<p>To install stateless you need to install YUM from the SDK DVD that comes with SLES10.1 as well as createrepo and all the dependencies.</p>
<p>Once you have it do:</p>
<pre><code>cd /install/sles10.1/x86_64
createrepo .</code></pre>
<p>Note: You need to do it in /install/sles10.1/x86_64 instead of /install/sles10.1/x86_64/1 otherwise it will ruin your YAST diskful installs.<br />Once done you need to use genimage.yum to make this work. Copy the code below into /opt/xcat/share/xcat/netboot/sles/genimage.yum</p>
<p>Note: You need to do it in /install/sles10.1/x86_64 instead of /install/sles10.1/x86_64/1 otherwise it will ruin your YAST diskful installs.</p>
<p>Once done you need to use genimage.yum to make this work. Copy the code below into /opt/xcat/share/xcat/netboot/sles/genimage.yum</p>
<pre><code>#!/usr/bin/env perl
use Data::Dumper;
use File::Basename;
use File::Path;
use File::Copy;
use File::Find;
use Getopt::Long;
#use strict;
Getopt::Long::Configure(&quot;bundling&quot;);
Getopt::Long::Configure(&quot;pass_through&quot;);

my $prinic; #TODO be flexible on node primary nic
my $othernics; #TODO be flexible on node primary nic
my $netdriver;
my @yumdirs;
my $arch = `uname -m`;
chomp($arch);
if ($arch =~ /i.86$/) {
$arch = x86;
}
my %libhash;
my @filestoadd;
my $profile;
my $osver;
my $pathtofiles=dirname($0);
my $name = basename($0);
my $onlyinitrd=0;
if ($name =~ /geninitrd/) {
$onlyinitrd=1;
}
my $rootlimit;
my $tmplimit;
my $installroot = &quot;/install&quot;;
my $kernelver = &quot;&quot;; #`uname -r`;
my $basekernelver; # = $kernelver;

sub xdie {
system(&quot;rm -rf /tmp/xcatinitrd.$$&quot;);
die @_;
}

$SIG{INT} = $SIG{TERM} = sub { xdie &quot;Interrupted&quot; };
GetOptions(
&#39;a=s&#39; =&amp;gt; \$arch,
&#39;p=s&#39; =&amp;gt; \$profile,
&#39;o=s&#39; =&amp;gt; \$osver,
&#39;n=s&#39; =&amp;gt; \$netdriver,
&#39;i=s&#39; =&amp;gt; \$prinic,
&#39;r=s&#39; =&amp;gt; \$othernics,
&#39;l=s&#39; =&amp;gt; \$rootlimit,
&#39;t=s&#39; =&amp;gt; \$tmplimit,
&#39;k=s&#39; =&amp;gt; \$kernelver
);
#Default to the first kernel found in the install image if nothing specified explicitly.
#A more accurate guess than whatever the image build server happens to be running
#If specified, that takes precedence.
#if image has one, that is used
#if all else fails, resort to uname -r like this script did before
my @KVERS= </code></pre>
</body>
</html>
