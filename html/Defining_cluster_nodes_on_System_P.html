<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#defining-cluster-nodes"><strong>Defining Cluster Nodes</strong></a><ul>
<li><a href="#using-the-mkdef-command"><strong>Using the mkdef command</strong></a></li>
<li><a href="#using-an-xcat-stanza-file"><strong>Using an xCAT stanza file</strong></a></li>
<li><a href="#discovering-and-defining-pre-existing-lpars"><strong>Discovering and defining pre-existing LPARs</strong></a><ul>
<li><a href="#using-rscan-to-discover-lpars"><strong>Using rscan to discover LPARs</strong></a></li>
<li><a href="#using-mkdef-after-rscan"><strong>Using mkdef after rscan</strong></a></li>
</ul></li>
<li><a href="#creating-new-lpars-and-node-definitions"><strong>Creating new LPARs and node definitions</strong></a><ul>
<li><a href="#define-the-nodes"><strong>Define the nodes</strong></a></li>
<li><a href="#create-new-lpars-using-mkvm"><strong>Create new LPARs using mkvm</strong></a></li>
</ul></li>
<li><a href="#using-a-cluster-configuration-file."><strong>Using a cluster configuration file.</strong></a></li>
<li><a href="#discover-hmcsframececs-and-define-them-in-xcat-db"><strong>Discover HMCs/frame/CECs, and define them in xCAT DB</strong></a><ul>
<li><a href="#using-the-lsslp-command"><strong>Using the lsslp command</strong></a></li>
</ul></li>
</ul></li>
</ul>
</div>
<p><!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> Table of Contents</p>
<ul>
<li><a href="#defining-cluster-nodes"><strong>Defining Cluster Nodes</strong></a></li>
<li><a href="#using-the-mkdef-command"><strong>Using the mkdef command</strong></a></li>
<li><a href="#using-an-xcat-stanza-file"><strong>Using an xCAT stanza file</strong></a></li>
<li><a href="#discovering-and-defining-pre-existing-lpars"><strong>Discovering and defining pre-existing LPARs</strong></a>
<ul>
<li><a href="#using-rscan-to-discover-lpars"><strong>Using rscan to discover LPARs</strong></a></li>
<li><a href="#using-mkdef-after-rscan"><strong>Using mkdef after rscan</strong></a></li>
</ul></li>
<li><a href="#creating-new-lpars-and-node-definitions"><strong>Creating new LPARs and node definitions</strong></a>
<ul>
<li><a href="#define-the-nodes"><strong>Define the nodes</strong></a></li>
<li><a href="#create-new-lpars-using-mkvm"><strong>Create new LPARs using mkvm</strong></a></li>
</ul></li>
<li><a href="#using-a-cluster-configuration-file"><strong>Using a cluster configuration file.</strong></a></li>
<li><a href="#discover-hmcsframececs-and-define-them-in-xcat-db"><strong>Discover HMCs/frame/CECs, and define them in xCAT DB</strong></a>
<ul>
<li><a href="#using-the-lsslp-command"><strong>Using the lsslp command</strong></a></li>
</ul></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->


<h2 id="defining-cluster-nodes"><a href="#TOC"><strong>Defining Cluster Nodes</strong></a></h2>
<p>There are several ways to create xCAT cluster node definitions. Use the method listed below that best fits your situation.</p>
<h3 id="using-the-mkdef-command"><a href="#TOC"><strong>Using the mkdef command</strong></a></h3>
<p>You can use the xCAT <strong>mkdef</strong> command to create basic xCAT node definitions.</p>
<p>For example:</p>
<pre><code>    mkdef -t node -o clstrn27 mgt=hmc os=AIX nodetype=ppc,osi hwtype=lpar groups=lpar,all,compute</code></pre>
<p>To get a description of all the valid attributes that may be specified for a node definition you can run the <strong>lsdef</strong> command as follows.</p>
<pre><code>    lsdef -t node -h | pg</code></pre>
<p>See the <strong>mkdef</strong> man page for more examples. (<a href="http://xcat.sourceforge.net/man1/mkdef.1.html">mkdef</a>)</p>
<h3 id="using-an-xcat-stanza-file"><a href="#TOC"><strong>Using an xCAT stanza file</strong></a></h3>
<p>A stanza file contains information that can be used to create xCAT data object definitions. A stanza file can be used as input to several xCAT commands. The stanza file contains one or more stanzas that provide information for individual object definitions.</p>
<p>For example, a node definition stanza could look like the following.</p>
<pre><code>    compute02:
       objtype=node
       groups=lpar,all,compute
       hcp=c98m6hmc01
       id=102
       mac=163D0D02C202
       mgt=hmc
       nodetype=ppc,osi
       hwtype=lpar
       os=AIX</code></pre>
<p>See the <strong>xcatstanzafile</strong> man page for more information and examples. (<a href="http://xcat.sourceforge.net/man5/xcatstanzafile.5.html">xcatstanzafile</a>)</p>
<p>Once you have created a stanza file you can pass the information to the <strong>mkdef</strong> command as follows.</p>
<pre><code>    cat mystanzafile | mkdef -z</code></pre>
<h3 id="discovering-and-defining-pre-existing-lpars"><a href="#TOC"><strong>Discovering and defining pre-existing LPARs</strong></a></h3>
<h4 id="using-rscan-to-discover-lpars"><a href="#TOC"><strong>Using rscan to discover LPARs</strong></a></h4>
<p>This method assumes that LPARs were already created using the standard HMC interfaces or the xCAT System p Direct FSP Management (xCAT DFM) support.</p>
<p>Use the xCAT <strong>rscan</strong> command to collect node information from one or more hardware control points.</p>
<p>The following example uses the &quot;-z&quot; option to create a stanza file that contains the information gathered by <strong>rscan</strong>. The information in the stanza file will also include some default values that could be used for the node definitions. (See the <strong>rscan</strong> man page for more information. <a href="http://xcat.sourceforge.net/man1/rscan.1.html">rscan</a>)</p>
<p>To write the stanza formated output of <strong>rscan</strong> to a file called &quot;mystanzafile&quot; run the following command.</p>
<pre><code>    rscan -z hmc01 &gt; mystanzafile</code></pre>
<p>This file can then be checked and modified as needed. For example you may need to add a different name for the node definition or add additional attributes and values etc.</p>
<p><strong>Note</strong>: The stanza file may contain stanzas for objects other than the LPARs. This information must also be defined in the xCAT database. It is not necessary to modify the non-LPAR stanzas in any way.</p>
<h4 id="using-mkdef-after-rscan"><a href="#TOC"><strong>Using mkdef after rscan</strong></a></h4>
<p>The information gathered by the **rscan **command can be used to create xCAT node definitions.</p>
<p>Since we have put all the node information in a stanza file we can now pass the contents of the file to the <strong>mkdef</strong> command to add the definitions to the database.</p>
<pre><code>    cat mystanzafile | mkdef -z</code></pre>
<p>You can use the xCAT <strong>lsdef</strong> command to check the definitions (ex. &quot;<em>lsdef -l node01</em>&quot;). After the node has been defined you can use the <strong>chdef</strong> command to make any additional updates to the definitions, if needed.</p>
<h3 id="creating-new-lpars-and-node-definitions"><a href="#TOC"><strong>Creating new LPARs and node definitions</strong></a></h3>
<p>You can use the xCAT <strong>mkvm</strong> command to create additional logical partitions.</p>
<p>See the <strong>mkvm</strong> man page for more details and usage. (<a href="http://xcat.sourceforge.net/man1/mkvm.1.html">mkvm</a>)</p>
<p>Also see the following for a description of using <strong>mkvm</strong> with the xCAT DFM support. [xCAT_System_p_Hardware_Management_for_DFM_Managed_Systems]</p>
<h4 id="define-the-nodes"><a href="#TOC"><strong>Define the nodes</strong></a></h4>
<p>Before running the <strong>mkvm</strong> command you must define the corresponding xCAT node definitions.</p>
<p>At a minimum the &quot;mgt&quot; and &quot;groups&quot; attribute of the node definitions must be set.</p>
<p>For example, to create a set of new node definitions you could run a command similar to the following.</p>
<pre><code>    mkdef -t node -o clstrn04-clstrn10 groups=all,aixnodes mgt=hmc</code></pre>
<p><strong>Note</strong>: In some cases you may want to use the <strong>xcatsetup</strong> command and a cluster configuration file to define the cluster nodes. See the section below for more information on using cluster configuration files.</p>
<h4 id="create-new-lpars-using-mkvm"><a href="#TOC"><strong>Create new LPARs using mkvm</strong></a></h4>
<p>To create the new partitions based on the partition profile for node clstrn01 you could run the following command.</p>
<pre><code>    mkvm -V clstn01 -i 4 -n clstrn04-clstrn10</code></pre>
<p><strong>Note</strong>: In some cases it is necessary to re-boot the hardware after running the <strong>mkvm</strong> command. Refer to the man page and documentation listed above for a more complete description.</p>
<h3 id="using-a-cluster-configuration-file."><a href="#TOC"><strong>Using a cluster configuration file.</strong></a></h3>
<pre><code>**This support will be available in xCAT 2.6 and beyond.**</code></pre>
<p>A cluster configuration file contains information that can be used to create initial xCAT cluster definitions for a new cluster. It can include hardware descriptions, node definitions, site information, naming conventions, IP addresses etc.</p>
<p>A cluster configuration file can be used with the xCAT <strong>xcatsetup</strong> command to &quot;prime&quot; the xCAT database.</p>
<p>The format of a cluster configuration file is described in the man page for the <strong>xcatsetup</strong> command. (<a href="http://xcat.sourceforge.net/man8/xcatsetup.8.html">xcatsetup</a>)</p>
<p>Once you have created the configuration file you can run the <strong>xcatsetup</strong> command as follows:</p>
<pre><code>    xcatsetup &gt; &lt;cluster_config_file&gt;</code></pre>
<h3 id="discover-hmcsframececs-and-define-them-in-xcat-db"><a href="#TOC"><strong>Discover HMCs/frame/CECs, and define them in xCAT DB</strong></a></h3>
<p>The xCAT <strong>lsslp</strong> command is used to discover the cluster hardware components such as the HMCs, frames, and CECs.</p>
<p>This command is normally used during the System P hardware discovery phase of the cluster bring-up.</p>
<p>See the <strong>lsslp</strong> man page for more details. (<a href="http://xcat.sourceforge.net/man1/lsslp.1.html">lsslp</a>)</p>
<p>Also see the following document for a complete description of the hardware discovery and management support. [XCAT_System_p_Hardware_Management_for_HMC_Managed_Systems] [xCAT_System_p_Hardware_Management_for_DFM_Managed_Systems]</p>
<h4 id="using-the-lsslp-command"><a href="#TOC"><strong>Using the lsslp command</strong></a></h4>
<p>The recommended process is to run the <strong>lsslp</strong> command to discover the hardware component and create a stanza file. Then pass the stanza file to the <strong>mkdef</strong> command to create the xCAT definitions.</p>
<p>For example, to gather the HMC information and write it to a stanza file</p>
<pre><code>    lsslp -m -s HMC -z -i 192.168.200.205 &gt; /defs/hmcstanzafile</code></pre>
<p>Note: You need to execute the -m (multicast) flag to reference later supported HMC V7R35x/V7R71 levels.</p>
<p>Review the stanza file and make modifications if necessary.</p>
<p>You will need to include the <strong>username</strong> and <strong>password</strong> attributes being used by the target HMC node. Make sure that the HMC host name and ip address is resolvable in the xCAT cluster name resolution (/etc/hosts or DNS).</p>
<p>Create the xCAT definitions using the <strong>mkdef</strong> command.</p>
<pre><code>    cat /defs/hmcstanzafile | mkdef -z</code></pre>
</body>
</html>
