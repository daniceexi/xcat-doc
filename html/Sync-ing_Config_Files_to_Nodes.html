<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#the-synclist-file">The synclist file</a><ul>
<li><a href="#the-format-of-synclist-file"><strong>The Format of synclist file</strong></a></li>
<li><a href="#an-example-of-synclist-file"><strong>An example of synclist file</strong></a><ul>
<li><a href="#postscript-support"><strong>postscript support</strong></a></li>
<li><a href="#advanced-synclist-file-features-execute-executealwaysappend-merge">Advanced synclist file features (EXECUTE, EXECUTEALWAYS,APPEND, MERGE)</a></li>
</ul></li>
<li><a href="#the-location-of-synclist-file-for-updatenode-and-install-process">The location of synclist file for updatenode and install process</a></li>
</ul></li>
<li><a href="#run-xdcp-command-to-perform-syncing-file-action">Run xdcp command to perform Syncing File action</a></li>
<li><a href="#synchronizing-files-during-the-installation-process">Synchronizing Files during the installation process</a><ul>
<li><a href="#hierarchy-and-service-nodes">Hierarchy and Service Nodes</a></li>
<li><a href="#diskfull-installation">Diskfull installation</a></li>
<li><a href="#diskless-installation">Diskless Installation</a></li>
<li><a href="#statelite-installation">Statelite Installation</a></li>
</ul></li>
<li><a href="#run-the-syncing-file-action-in-the-creating-diskless-image-process">Run the Sync'ing File action in the creating diskless image process</a></li>
<li><a href="#run-the-syncing-file-action-in-the-updatenode-process">Run the Syncing File action in the updatenode process</a></li>
<li><a href="#run-the-syncing-file-action-periodically">Run the Syncing File action periodically</a></li>
</ul>
</div>
<p><!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> Table of Contents</p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#the-synclist-file">The synclist file</a></li>
<li><a href="#the-format-of-synclist-file"><strong>The Format of synclist file</strong></a></li>
<li><a href="#an-example-of-synclist-file"><strong>An example of synclist file</strong></a>
<ul>
<li><a href="#postscript-support"><strong>postscript support</strong></a></li>
<li><a href="#advanced-synclist-file-features-execute-executealwaysappend-merge">Advanced synclist file features (EXECUTE, EXECUTEALWAYS,APPEND, MERGE)</a></li>
</ul></li>
<li><a href="#the-location-of-synclist-file-for-updatenode-and-install-process">The location of synclist file for updatenode and install process</a></li>
<li><a href="#run-xdcp-command-to-perform-syncing-file-action">Run xdcp command to perform Syncing File action</a></li>
<li><a href="#synchronizing-files-during-the-installation-process">Synchronizing Files during the installation process</a></li>
<li><a href="#hierarchy-and-service-nodes">Hierarchy and Service Nodes</a></li>
<li><a href="#diskfull-installation">Diskfull installation</a></li>
<li><a href="#diskless-installation">Diskless Installation</a></li>
<li><a href="#statelite-installation">Statelite Installation</a></li>
<li><a href="#run-the-syncing-file-action-in-the-creating-diskless-image-process">Run the Sync'ing File action in the creating diskless image process</a></li>
<li><a href="#run-the-syncing-file-action-in-the-updatenode-process">Run the Syncing File action in the updatenode process</a></li>
<li><a href="#run-the-syncing-file-action-periodically">Run the Syncing File action periodically</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<div class="figure">
<img src="http://sourceforge.net/p/xcat/wiki/XCAT_Documentation/attachment/Official-xcat-doc.png" /><p class="caption"></p>
</div>
<h2 id="overview"><a href="#TOC">Overview</a></h2>
<p>Synchronizing (sync) files to the nodes is a feature of xCAT used to distribute specific files from the management node to the new-deploying or deployed nodes.</p>
<p>This function is supported for diskfull or RAMdisk-based diskless nodes. <strong>The function is not supported for NFS-based statelite nodes.</strong> To sync files to statelite nodes you should use the read-only option for files/directories listed in litefile table with the source location specified in the litetree table. For more information on using setting up Statelite deployments, see [XCAT_Linux_Statelite] or [XCAT_AIX_Diskless_Nodes].</p>
<p>Generally, the specific files are usually the system configuration files for the nodes in the /etc/directory, like /etc/hosts, /etc/resolve.conf; it also could be the application programs configuration files for the nodes. The advantages of this function are: it can parallel sync files to the nodes or nodegroup for the installed nodes; it can automatically sync files to the newly-installing node after the installation. Additionally, this feature also supports the flexible format to define the synced files in a configuration file, called 'synclist'.</p>
<p>The synclist file can be a common one for a group of nodes using the same profile or osimage, or can be the special one for a particular node. Since the location of the synclist file will be used to find the synclist file, the common synclist should be put in a given location for Linux nodes or specified by the osimage.synclists attribute for the AIX nodes, The special synclist file for a certain node only can be accepted in the 'xdcp -F synclist' command.</p>
<p>xdcp command supplies the basic Syncing File function. If the '-F synclist' option is specified in the xdcp command, it syncs files configured in the synclist to the nodes. If the '-i PATH' option is specified with '-F synclist', it syncs files to the root image located in the PATH directory. (Note: the '-i PATH' option is only supported for Linux nodes)</p>
<p>xdcp supports hierarchy where service nodes are used. If a node is serviced by a service node, xdcp will sync the files to the service node first, then sync the files from service node to the compute node. The files are place in an intermediate directory on the service node defined by the SNsyncfiledir attribute in the site table. The default is /var/xcat/syncfiles.</p>
<p>Since 'updatenode -F' calls the xdcp to handle the Syncing File function, the 'updatenode -F' also supports the hierarchy.</p>
<p>For a new-installing nodes, the Syncing File action will be triggered when performing the postscripts for the nodes. A special postscript named 'syncfiles' is used to initiate the Syncing File process.</p>
<p>The postscript 'syncfiles' is located in the /install/postscripts/. When running, it sends a message to the xcatd on the management node or service node, then the xcatd figures out the corresponding synclist file for the node and calls the xdcp command to sync files in the synclist to the node.</p>
<p><strong>If installing nodes in a hierarchical configuration, you must sync the Service Nodes first to make sure they are updated. The compute nodes will be sync'd from their service nodes. In 2.6 or later, you can use the updatenode &lt;computenodes&gt; -f command to sync all the service nodes for range of compute nodes provided.</strong> ****</p>
<p>For an installed nodes, the Syncing File action happens when performing the 'updatenode -F' or 'xdcp -F synclist' command to update a nodes. If performing the 'updatenode -F', it figures out the location of the synclist files for all the nodes and classify the nodes which using same synclist file and then calls the 'xdcp -F synclist' to sync files to the nodes.</p>
<h2 id="the-synclist-file"><a href="#TOC">The synclist file</a></h2>
<h3 id="the-format-of-synclist-file"><a href="#TOC"><strong>The Format of synclist file</strong></a></h3>
<p>The synclist file contains the configuration entries that specify where the files should be synced to. In the synclist file, each line is an entry which describes the location of the source files and the destination location of files on the target node.</p>
<p>The basic entry format looks like following:</p>
<pre><code>    path_of_src_file1 -&gt; path_of_dst_file1
    path_of_src_file1 -&gt; path_of_dst_directory ( must end in / if only one file to sync) 2.5 or later
    path_of_src_file1 path_of_src_file2 ... -&gt; path_of_dst_directory</code></pre>
<p>The path_of_src_file* should be the full path of the source file on the Management Node.</p>
<p>The path_of_dst_file* should be the full path of the destination file on target node.</p>
<p>The path_of_dst_directory should be the full path of the destination directory.</p>
<p>Since the synclist file is for common purpose, the target node need not be configured in it.</p>
<p>Example: the following synclist formats are supported:</p>
<p>sync file /etc/file2 to the file /etc/file2 on the node (with same file name)</p>
<pre><code>    /etc/file2 -&gt; /etc/file2</code></pre>
<p>sync file /etc/file2 to the file /etc/file3 on the node (with different file name)</p>
<pre><code>    /etc/file2 -&gt; /etc/file3</code></pre>
<p>sync file /etc/file4 to the file /etc/tmp/file5 on the node( different file name and directory). The directory will be automatically created for you.</p>
<pre><code>    /etc/file4 -&gt; /etc/tmp/file5</code></pre>
<p>sync the multiple files /etc/file1, /etc/file2, /etc/file3, ... to the directory /tmp/etc (/tmp/etc must be a directory when multiple files are synced at one time). If the directory does not exist, xdcp will create it.</p>
<pre><code>    /etc/file1 /etc/file2 /etc/file3 -&gt; /tmp/etc</code></pre>
<p>sync file /etc/file2 to the file /etc/file2 on the node ( with the same file name) (2.5 or later)</p>
<pre><code>    /etc/file2 -&gt; /etc/</code></pre>
<p>sync all files in /home/mikev to directory /home/mikev on the node (2.5 or later)</p>
<pre><code>    /home/mikev/* -&gt; /home/mikev/</code></pre>
<p>Note: Don't try to sync files to the read only directory on the target node.</p>
<h3 id="an-example-of-synclist-file"><a href="#TOC"><strong>An example of synclist file</strong></a></h3>
<p>Assume a user wants to sync files to a node as following, the corresponding entries should be added in a synclist file.</p>
<p>Sync the file /etc/common_hosts to the two places on the target node: put one to the /etc/hosts, the other to the /tmp/etc/hosts. Following configuration entries should be added:</p>
<pre><code>    /etc/common_hosts -&gt; /etc/hosts
    /etc/common_hosts -&gt; /tmp/etc/hosts</code></pre>
<p>Sync files in the directory/tmp/prog1 to the directory /prog1 on the target node, and the postfix '.tmpl' needs to be removed on the target node. (directory /tmp/prog1/ contains two files: conf1.tmpl and conf2.tmpl) Following configuration entries should be added:</p>
<pre><code>    /tmp/prog1/conf1.tmpl -&gt; /prog1/conf1
    /tmp/prog1/conf2.tmpl -&gt; /prog1/conf2</code></pre>
<p>Sync the files in the directory /tmp/prog2 to the directory /prog2 with same name on the target node. (directory /tmp/prog2 contains two files: conf1 and conf2) Following configuration entries should be added:</p>
<pre><code>    /tmp/prog2/conf1 /tmp/prog2/conf2 -&gt; /prog2</code></pre>
<p>Sample synclist file</p>
<pre><code>    /etc/common_hosts -&gt; /etc/hosts
    /etc/common_hosts -&gt; /tmp/etc/hosts
    /tmp/prog1/conf1.tmpl -&gt; /prog1/conf1
    /tmp/prog1/conf2.tmpl -&gt; /prog1/conf2
    /tmp/prog2/conf1 /tmp/prog2/conf2 -&gt; /prog2
    /tmp/* -&gt; /tmp/ ( 2.5 or later)
    /etc/testfile -&gt; /etc/ ( 2.5 or later)</code></pre>
<p>If the above syncfile is performed by the updatenode/xdcp commands, or performed in a node installation process, the following files will exist on the target node with the following contents.</p>
<pre><code>    /etc/hosts(It has the same content with /etc/common_hosts on the MN)
    /tmp/etc/hosts(It has the same content with /etc/common_hosts on the MN)
    /prog1/conf1(It has the same content with /tmp/prog1/conf1.tmpl on the MN)
    /prog1/conf2(It has the same content with /tmp/prog1/conf2.tmpl on the MN)
    /prog2/conf1(It has the same content with /tmp/prog2/conf1 on the MN)
    /prog2/conf2(It has the same content with /tmp/prog2/conf2 on the MN)</code></pre>
<h4 id="postscript-support"><a href="#TOC"><strong>postscript support</strong></a></h4>
<p>As of <strong>xCAT 2.6</strong>, after you define the files to rsync in the syncfile, you can add an <strong>EXECUTE:</strong> clause in the syncfile. The <strong>EXECUTE:</strong> clause will list all the postscripts that you would like to run after the files are sync'd to the node. The postscript file must be of the form <strong>filename.post</strong>, where filename is the name of the <strong>from</strong> file, reside in the same directory as <strong>filename</strong>, and be executable. If the file <strong>filename</strong> is rsync'd to the node, then the <strong>filename.post</strong> will automatically be run on the node. If the file <strong>filename</strong> is not updated on the node, the <strong>filename.pos</strong>t will not be run.</p>
<p>Putting the <strong>filename.post</strong> in the rsyncfile to rsync to the node is required for hierarchical clusters. It is optional for non-hierarchical cluster.</p>
<h4 id="advanced-synclist-file-features-execute-executealwaysappend-merge"><a href="#TOC">Advanced synclist file features (EXECUTE, EXECUTEALWAYS,APPEND, MERGE)</a></h4>
<p>As of <strong>xCAT 2.8</strong>, after you define the files to rsync in the syncfile, you can add an <strong>EXECUTEALWAYS</strong> clause in the syncfile. The <strong>EXECUTEALWAYS</strong> clause will list all the postscripts you would always like to run after the files are sync'd, whether or not any file is actually updated. The files in this list must be added to the list of files to rsync, if hierarchical.</p>
<p>For example, your rsyncfile may look like this. **Note: the path to the file to EXECUTE, is the location of the <em>.post file on the MN.</em>*</p>
<pre><code>    /tmp/share/file2  -&gt; /tmp/file2
    /tmp/share/file2.post -&gt; /tmp/file2.post (required for hierarchical clusters)
    /tmp/share/file3 -&gt; /tmp/file3
    /tmp/share/file3.post -&gt; /tmp/file3.post (required for hierarchical clusters)
    /tmp/myscript1 -&gt; /tmp/myscript1
    /tmp/myscript2 -&gt; /tmp/myscript2
    # the below are postscripts
    EXECUTE:
    /tmp/share/file2.post
    /tmp/share/file3.post
    EXECUTEALWAYS:  ( only in 2.8 and later)
    /tmp/myscript1
    /tmp/myscript2</code></pre>
<p>If /tmp/file2 is updated on the node in /tmp/file2, then /tmp/file2.post is automatically run on that node. If /tmp/file3 is updated on the node in /tmp/filex, then /tmp/file3.post is automatically run on that node.</p>
<p>As of xCAT 2.8, you can add an <strong>APPEND</strong> clause to your syncfile.</p>
<p>The <strong>APPEND</strong> clause is used to append the contents of the input file to an existing file on the node. The file to be appended must already exist on the node and not be part of the synclist that contains the <strong>APPEND</strong> clause.</p>
<p>For example, your synclist file may look like this:</p>
<pre><code>    /tmp/share/file2  -&gt;  /tmp/file2
    /tmp/share/file2.post -&gt; /tmp/file2.post
    /tmp/share/file3  -&gt;  /tmp/filex
    /tmp/share/file3.post -&gt; /tmp/file3.post
    /tmp/myscript -&gt; /tmp/myscript
    # the below are postscripts
    EXECUTE:
    /tmp/share/file2.post
    /tmp/share/file3.post
    EXECUTEALWAYS:
    /tmp/myscript
    APPEND:
    /etc/myappenddir/appendfile -&gt; /etc/mysetup/setup
    /etc/myappenddir/appendfile2 -&gt; /etc/mysetup/setup2</code></pre>
<p>When you use the APPEND clause, the file (left) of the arrow is appended to the file right of the arrow. In this example, /etc/myappenddir/appendfile is appended to /etc/mysetup/setup file, which must already exist on the node. The /opt/xcat/share/xcat/scripts/xdcpappend.sh is used to accomplish this.</p>
<p>The script creates a backup of the original file on the node in the directory defined by the <strong>site</strong> table <strong>nodesyncfiledir</strong> attribute, which is /var/xcat/node/syncfiles by default. To update the original file when using the function, you need to rsync a new original file to the node, removed the old original from the /var/xcat/node/syncfiles/org directory. If you want to cleanup all the files for the append function on the node, you can use the xdsh -c flag. See man page for xdsh.</p>
<p>Note: no order of execution may be assumed by the order that the EXECUTE,EXECUTEALWAYS and APPEND clause fall in the synclist file.</p>
<p>As of xCAT 2.8, you can add an <strong>MERGE</strong> clause to your syncfile. This is only supported on Linux.</p>
<p>The <strong>MERGE</strong> clause is used to append the contents of the input file to either the /etc/passwd, /etc/shadow or /etc/group files. They are the only supported files. You must not put the /etc/passwd, /etc/shadow, /etc/group files in an <strong>APPEND</strong> clause if using a <strong>MERGE</strong> clause. For these three file you should use a <strong>MERGE</strong> clause. The <strong>APPEND</strong> will add the information to the end of the file. The <strong>MERGE</strong> will add or replace the information and insure that there are no duplicate entries in these files.</p>
<p>For example, your synclist file may look like this:</p>
<pre><code>    /tmp/share/file2  -&gt;  /tmp/file2
    /tmp/share/file2.post -&gt; /tmp/file2.post
    /tmp/share/file3  -&gt;  /tmp/filex
    /tmp/share/file3.post -&gt; /tmp/file3.post
    /tmp/myscript -&gt; /tmp/myscript
    # the below are postscripts
    EXECUTE:
    /tmp/share/file2.post
    /tmp/share/file3.post
    EXECUTEALWAYS:
    /tmp/myscript
    MERGE:
    /etc/mydir/mergepasswd -&gt; /etc/passwd
    /etc/mydir/mergeshadow -&gt; /etc/shadow
    /etc/mydir/mergegroup -&gt; /etc/group</code></pre>
<p>When you use the MERGE clause, the file (left) of the arrow is merged into the file right of the arrow. It will replace any common userid's found in those files and add new userids. The /opt/xcat/share/xcat/scripts/xdcpmerge.sh is used to accomplish this.</p>
<p>Note: no order of execution may be assumed by the order that the EXECUTE,EXECUTEALWAYS,APPEND and MERGE clause fall in the synclist file.</p>
<h3 id="the-location-of-synclist-file-for-updatenode-and-install-process"><a href="#TOC">The location of synclist file for updatenode and install process</a></h3>
<p><a href="The_location_of_synclist_file_for_updatenode_and_install_process">The_location_of_synclist_file_for_updatenode_and_install_process</a></p>
<h2 id="run-xdcp-command-to-perform-syncing-file-action"><a href="#TOC">Run xdcp command to perform Syncing File action</a></h2>
<p>xdcp command supplies three options '-F' , -s, and '-i' to support the Syncing File function.</p>
<ul>
<li>-F|--File rsync input file</li>
</ul>
<p>Specifies the full path to the synclist file that will be used to build the rsync command</p>
<ul>
<li>-s</li>
</ul>
<p>Specifies to rsync to the service nodes only for the input compute noderange.</p>
<ul>
<li>-i|--rootimg install image for Linux</li>
</ul>
<p>Specifies the full path to the install image on the local node. By default, if the -F option is specified, the 'rsync' command is used to perform the syncing file function. For the rsync in xdcp, only the ssh remote shell is supported for rsync.xdcp uses the '-Lpotz' as the default flags to call the rsync command. More flags for rsync command can be specified by adding '-o' flag to the call to xdcp.</p>
<p>For example:</p>
<p>Using xdcp '-F' option to sync files which are listed in the /install/custom/commonsyncfiles/compute.synclist directory to the node group named 'compute'. If the node group compute is serviced by servicenodes, then the files will be automatically staged to the correct service nodes, and then synced to the compute nodes from those service nodes. The files will be stored in /var/xcat/syncfiles directory on the service nodes by default, or in the directory indicated in the site.SNsyncfiledir attribute. See -s option below.</p>
<pre><code>    xdcp compute -F /install/custom/commonsynfiles/compute.synclist</code></pre>
<p>For Linux nodes, using xdcp '-i' option with '-F' to sync files created in the /install/custom/install/sles11/compute.synclist to the osimage in the directory /install/netboot/sles11/ppc64/compute/rootimg</p>
<pre><code>   xdcp -i /install/netboot/sles11/ppc64/compute/rootimg -F /install/custom/install/sles11
     /compute.synclist</code></pre>
<p>Using the xdcp '-s' option to sync the files only to the service nodes for the node group named 'compute'. The files will be placed in the default /var/xcat/syncfiles directory or in the directory as indicated in the site.SNsyncfiledir attribute. If you want the files synched to the same directory on the service node that they come from on the Management Node, set site.SNsyncfiledir=/. This can be setup before a node install, to have the files available to be synced during the install.</p>
<pre><code>    xdcp compute -s -F /install/custom/install/sles11/compute.synclist</code></pre>
<h2 id="synchronizing-files-during-the-installation-process"><a href="#TOC">Synchronizing Files during the installation process</a></h2>
<p>The policy table must have the entry to allow syncfiles postscript to access the Management Node. Make sure this entry is in your table:</p>
<pre><code>    tabdump policy
    #priority,name,host,commands,noderange,parameters,time,rule,comments,disable
    .
    .
    &quot;4.6&quot;,,,&quot;syncfiles&quot;,,,,&quot;allow&quot;,,
    .
    .</code></pre>
<h3 id="hierarchy-and-service-nodes"><a href="#TOC">Hierarchy and Service Nodes</a></h3>
<p>If using Service nodes to manage you nodes, you should make sure that the service nodes have been synchronized with the latest files from the Management Node before installing. As of xCAT 2.6.6, the updatenode command can do this for you. If you have a group of compute nodes (compute) that are going to be installed that are serviced by SN1, then run the following before the install to sync the current files to SN1. Note: the noderange is the compute node names, updatenode will figure out which service nodes need updating.</p>
<pre><code>    updatenode compute -f</code></pre>
<h3 id="diskfull-installation"><a href="#TOC">Diskfull installation</a></h3>
<p>The 'syncfiles' postscript is in the defaults section of the postscripts table. To enable the syn files postscript to sync files to the nodes during install the user need to do the following:</p>
<ul>
<li>Create the synclist file with the entries indicating which files should be synced. Section 2.1 and 2.2 is a good example for how to create the synclist file.)</li>
<li>For Linux:Put the synclist into the proper location for the node type (refer Linux part of</li>
</ul>
<p><a href="Sync-ing_Config_Files_to_Nodes/#the-location-of-synclist-file-for-updatenode-and-install-process">Sync-ing_Config_Files_to_Nodes/#the-location-of-synclist-file-for-updatenode-and-install-process</a></p>
<p>Make sure your postscripts table has the syncfiles postscript listed:</p>
<pre><code>    tabdump postscripts
    #node,postscripts,postbootscripts,comments,disable
    &quot;xcatdefaults&quot;,&quot;syslog,remoteshell,syncfiles&quot;,&quot;otherpkgs&quot;,,</code></pre>
<ul>
<li>For AIX:Set the full path of synclist file as the value of the osimage.synclists attribute.</li>
</ul>
<h3 id="diskless-installation"><a href="#TOC">Diskless Installation</a></h3>
<p>The diskless boot is similar with the diskfull installation for the synchronizing files operation, except that the packimage (for Linux) and mkdsklsnode (for AIX) commands will sync files to the root directories of image during the creating image process.</p>
<p>Creating the synclist file as the steps in Diskfull installation section, then the synced files will be synced to the os image during the packimage and mkdsklsnode commands running.</p>
<p>Also the files will always be re-synced during the booting up of the diskless node.</p>
<h3 id="statelite-installation"><a href="#TOC">Statelite Installation</a></h3>
<p><strong>The function is not supported for NFS-based statelite installations.</strong> For NFS-based statelite installations to sync files you should use the read-only option for files/directories listed in litefile table with source location specified in the litetree table. For more information on using setting up Statelite installs, see [XCAT_Linux_Statelite].</p>
<h2 id="run-the-syncing-file-action-in-the-creating-diskless-image-process"><a href="#TOC">Run the Sync'ing File action in the creating diskless image process</a></h2>
<p>For the Linux and AIX nodes, different approaches are used to create the diskless image. The Sync'ing File action is also different.</p>
<p>Linux:</p>
<p>For Linux nodes, the packimage command is used to prepare the root image files and package the root image. The Syncing File action is performed here.</p>
<p>Steps to make the Sync'ing File working in the packimage command:</p>
<ul>
<li><p>Prepare the synclist file and put it into the appropriate location as describe above in <a href="Sync-ing_Config_Files_to_Nodes/#the-location-of-synclist-file-for-updatenode-and-install-process">Sync-ing_Config_Files_to_Nodes/#the-location-of-synclist-file-for-updatenode-and-install-process</a></p></li>
<li><p>Run packimage as is normally done.</p></li>
</ul>
<p>AIX:</p>
<p>For AIX nodes, the xCAT mknimimage command may be used to synchronize files in an AIX diskless image. The will use the information in the “synclists” file to update the appropriate NIM SPOT resource. To have files automatically synchronized when creating an AIX diskless image.</p>
<ul>
<li>Prepare the synclist file.</li>
<li>Run the <strong>mknimimage</strong> command to create the initial diskless image. Provide the name of the synclist file on the command line using an “attr=value” pair. ( ex. synclists=”/install/mysyncfile”)</li>
</ul>
<p>The mknimimage command can also be used to update an AIX diskless image after it has been defined. See the mknimimage man page for details.</p>
<h2 id="run-the-syncing-file-action-in-the-updatenode-process"><a href="#TOC">Run the Syncing File action in the updatenode process</a></h2>
<p>If run updatenode command with -F option, it syncs files which configured in the synclist to the nodes. updatenode does not sync images, use xdcp -i -F option to sync Linux images.</p>
<p>updatenode can be used to sync files to to diskfull or diskless nodes. updatenode cannot be used to sync files to statelite nodes.</p>
<p>Steps to make the Syncing File working in the 'updatenode -F' command:</p>
<ol style="list-style-type: decimal">
<li>Create the synclist file with the entries indicating which files should be synced. (Section 2.1 and 2.2 is a good example for how to create the synclist file.)</li>
<li>For Linux:Put the synclist into the proper location (refer to Linux part of section 2.3).</li>
<li>For AIX: Set the full path of synclist file as the value of the osimage.synclists attribute (refer to AIX part of section 2.3).</li>
<li>Run the 'updatenode node -F' command to initiate the Syncing File action.</li>
</ol>
<p><em>Note: Since Syncing File action can be initiated by the 'updatenode -F' flag, the 'updatenode -P' does NOT support to re-run the 'syncfiles' postscript, even if you specify the 'syncfiles' postscript in the updatenode command line or set the 'syncfiles' in the postscripts.postscripts attribute.</em></p>
<h2 id="run-the-syncing-file-action-periodically"><a href="#TOC">Run the Syncing File action periodically</a></h2>
<p>If the admins want to run the Syncing File action automatically or periodically, the 'xdcp -F', 'xdcp -i -F' and 'updatenode -F' commands can be used in the script, crontab or FAM directly.</p>
<p>For example:</p>
<p>Use the cron daemon to sync files in the /install/custom/install/sles/compute.sles11.synclist to the nodegroup 'compute' every 10 minutes by the xdcp command by adding this to crontab.</p>
<pre><code>    */10 * * * * root /opt/xcat/bin/xdcp compute -F /install/custom/install
     /sles/compute.sles11.synclist</code></pre>
<p>Use the cron daemon to sync files for the nodegroup 'compute' every 10 minutes by updatenode command.</p>
<pre><code>    */10 * * * * root /opt/xcat/bin/updatenode compute -F</code></pre>
</body>
</html>
