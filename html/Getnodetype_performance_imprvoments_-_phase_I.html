<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<p>{{:Design Warning}}</p>
<p>We think the following could be done and could gain a lot of performance improvement with minimal impact on the existing code. If I am missing something in the PPC code logic that will make this not work, please let me know.</p>
<p>The DBobjUtils-&gt;getnodetype routine would have a new and optional input flag which would allow the calling routine to tell it what table to check first for it's nodetype. If the flag is not input, the logic will stay the same as today. The logic will be the following for both the array and single node processing:</p>
<p>If the flag is not set</p>
<pre><code>  First read the nodetype table for the node or array of nodes to get the nodetype.
  If nodetype for the node is found save it
  if nodetype is another table (like PPC)
      read the  PPC table  for the  node&#39;s nodetype
      if found
         save it</code></pre>
<p>If new flag is set to a table ( like PPC)</p>
<pre><code> First read the PPC table for the node or array of nodes to get the nodetype
 If the node&#39;s nodetype is  found, save it
 If nodetype not found in the PPC table then
     read the nodetype table for the node&#39;s nodetype  ( or should we just return not found)
     If found, save it
     else If nodetype.nodetype points to a table (PPC)
        return nothing
     else If no nodetype
          return nothing</code></pre>
<p>The plan would be to only modify the calling code to set this flag, if it can. This would mean we would not change a lot of calls to additionally read the nodetype parameter on the PPC table read. So for example, the following code would only be changed to add the new flag in PPCconn.pm</p>
<p>my $node_parent_hash = $ppctab-&gt;getNodeAttribs( $node,[qw(parent)]);</p>
<pre><code>           #$nodetype    = $nodetype_hash-&amp;gt;{nodetype};
           $nodetype = xCAT::DBobjUtils-&amp;gt;getnodetype($node,&quot;PPC&quot;);</code></pre>
</body>
</html>
