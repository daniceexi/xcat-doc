<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#example-environment">Example environment</a></li>
<li><a href="#setup-the-management-node">Setup the management node</a><ul>
<li><a href="#setup-samba-on-the-management-node">Setup Samba on the management node</a></li>
<li><a href="#make-a-samba-directory">Make a samba directory</a></li>
<li><a href="#get-the-installation-iso-for-windows-server-2008">Get the installation ISO for Windows Server 2008</a></li>
<li><a href="#copy-the-installation-files-to-management-node">Copy the installation files to management node</a></li>
</ul></li>
<li><a href="#create-the-windows-boot-image">Create the windows boot image</a><ul>
<li><a href="#install-the-windows-pe-node-w1">Install the windows PE node w1</a></li>
<li><a href="#download-the-automated-install-kit-aik">Download the Automated Install Kit (AIK)</a></li>
<li><a href="#install-the-aik">Install the AIK</a></li>
<li><a href="#copy-the-xcat-tools-to-pe-node">Copy the xCAT tools to PE node</a></li>
<li><a href="#add-the-additional-device-drivers-on-w1">Add the additional device drivers on w1</a></li>
<li><a href="#generate-the-pe-image-on-the-pe-node-w1">Generate the PE image on the PE node w1</a></li>
<li><a href="#define-the-compute-node">Define the compute node</a></li>
<li><a href="#install-the-windows-node">Install the Windows Node</a></li>
<li><a href="#reference">Reference</a></li>
</ul></li>
</ul>
</div>
<p><!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> Table of Contents</p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#example-environment">Example environment</a></li>
<li><a href="#setup-the-management-node">Setup the management node</a></li>
<li><a href="#setup-samba-on-the-management-node">Setup Samba on the management node</a></li>
<li><a href="#make-a-samba-directory">Make a samba directory</a></li>
<li><a href="#get-the-installation-iso-for-windows-server-2008">Get the installation ISO for Windows Server 2008</a></li>
<li><a href="#copy-the-installation-files-to-management-node">Copy the installation files to management node</a></li>
<li><a href="#create-the-windows-boot-image">Create the windows boot image</a></li>
<li><a href="#install-the-windows-pe-node-w1">Install the windows PE node w1</a></li>
<li><a href="#download-the-automated-install-kit-aik">Download the Automated Install Kit (AIK)</a></li>
<li><a href="#install-the-aik">Install the AIK</a></li>
<li><a href="#copy-the-xcat-tools-to-pe-node">Copy the xCAT tools to PE node</a></li>
<li><a href="#add-the-additional-device-drivers-on-w1">Add the additional device drivers on w1</a></li>
<li><a href="#generate-the-pe-image-on-the-pe-node-w1">Generate the PE image on the PE node w1</a></li>
<li><a href="#define-the-compute-node">Define the compute node</a></li>
<li><a href="#install-the-windows-node">Install the Windows Node</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<p><strong>This page has be replaced by [XCAT_Windows].</strong></p>
<h1 id="overview"><a href="#TOC">Overview</a></h1>
<p>This page contains directions for installing a Windows 2008 Server Enterprise (x86 / x86_64) node with xCAT.</p>
<h1 id="requirements"><a href="#TOC">Requirements</a></h1>
<p>The xCAT 2.1 and later need to be installed and setup on the management node.</p>
<h1 id="example-environment"><a href="#TOC">Example environment</a></h1>
<p>A management node: mn1 (xCAT has been installed and setup correctly)<br />A compute node: node1 (The target node for deploying windows 2008 server Operating System.)<br />A Windows PE node w1 (A node to install the Windows Server 2008 manually - the architecture must be the same with the compute node: node1.) This node will be used to generate the PE image for the windows installation.</p>
<h1 id="setup-the-management-node"><a href="#TOC">Setup the management node</a></h1>
<h2 id="setup-samba-on-the-management-node"><a href="#TOC">Setup Samba on the management node</a></h2>
<p>The samba must be installed and setup on the mn1. During the installation, the compute node will use samba to connect to the mn1:/install/autoinst directory to get the installation configuration file (&lt;IP&gt;.cmd).<br />Make sure that a samba service is installed. To install samba, run the command:</p>
<pre><code>yum install samba</code></pre>
<p>Edit /etc/samba/smb.conf<br />In the [global] section, change security to:</p>
<pre><code>security = share</code></pre>
<p>Paste the following lines under Share Definitions</p>
<pre><code>[install]
path = /install
public = yes
writable = yes</code></pre>
<p>Restart the Samba server.</p>
<pre><code>service smb restart</code></pre>
<h2 id="make-a-samba-directory"><a href="#TOC">Make a samba directory</a></h2>
<p>Create a directory at the /install for transporting the files between the mn1 and w1.</p>
<pre><code># mkdir -p /install/support</code></pre>
<h2 id="get-the-installation-iso-for-windows-server-2008"><a href="#TOC">Get the installation ISO for Windows Server 2008</a></h2>
<p>The ISO's for Windows Server 2008 can be downloaded from here <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=13C7300E-935C-415A-A79C-538E933D5424&amp;WT.sp=_technet_,dcsjwb9vb00000c932fd0rjc7_5p3t&amp;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyId=13C7300E-935C-...</a>. But they won't be much use without a valid product key.</p>
<h2 id="copy-the-installation-files-to-management-node"><a href="#TOC">Copy the installation files to management node</a></h2>
<p>Run the copycds command on the mn1 to copy the files from ISO of windows server 2008 to the xCAT installation directory (default is /install).</p>
<pre><code># copycds Win2k8.iso -n win2k8 -a x86_64</code></pre>
<h1 id="create-the-windows-boot-image"><a href="#TOC">Create the windows boot image</a></h1>
<h2 id="install-the-windows-pe-node-w1"><a href="#TOC">Install the windows PE node w1</a></h2>
<p>A boot image is needed to be created on a windows node which has the same architecture and Operating System version with the target compute node. So a windows node is needed to be installed manually first. The ISO file should use the one that downloaded in preceding step.</p>
<h2 id="download-the-automated-install-kit-aik"><a href="#TOC">Download the Automated Install Kit (AIK)</a></h2>
<p>On the management node, download the Automated Install Kit (AIK) ISO from here: <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=696DD665-9F76-4177-A811-39C26D3B3B34&amp;displaylang=en">http://www.microsoft.com/downloads/en/details.aspx?FamilyID=696DD665-9F76-...</a><br />For example, the downloaded iso name is KB3AIK_EN.iso.<br />Since there is a samba service bas been setup on the management node mn1, copy all files from the AIK iso to a samba directory, then copy them to the windows PE node w1.<br />Mount the KB3AIK_EN.iso to a directory:</p>
<pre><code># mount -o loop KB3AIK_EN.iso /mnt</code></pre>
<p>Copy all the files to the samba directory:</p>
<pre><code># cp -a /mnt/* /install/support</code></pre>
<h2 id="install-the-aik"><a href="#TOC">Install the AIK</a></h2>
<p>On the Windows image node w1, following the steps: start-&gt;compute-&gt;’Map Network Drive’ to make the samba mn1:/install to be a partition (for example: d:/) of the w1.<br />Get into the new partition and find the file named waik&lt;arch&gt; base on your architecture, and then run it to install the AIK on the w1.</p>
<h2 id="copy-the-xcat-tools-to-pe-node"><a href="#TOC">Copy the xCAT tools to PE node</a></h2>
<p>On the management node, copy all files from the directory /opt/xcat/share/xcat/netboot/windows/ to the exported directory /install/support. (genimage.bat and startnet.cmd)</p>
<pre><code># cp -a /opt/xcat/share/xcat/netboot/windows/* /install/support/</code></pre>
<h2 id="add-the-additional-device-drivers-on-w1"><a href="#TOC">Add the additional device drivers on w1</a></h2>
<p>xCAT supports to add the additional device drivers to the PE image, you can download them and copy them to the c:at the w1.<br />For IBM system x server, the driver of network card (Broadcom) can be downloaded here: <a href="http://www-947.ibm.com/support/entry/portal/docdisplay?brand=5000020&amp;lndocid=MIGR-64537">http://www-947.ibm.com/support/entry/.../docdisplay?brand=5000020&amp;lndocid=MIGR-64537</a>.</p>
<p>Create a new directory c:/drivers at the PE node w1.<br />Then run the downloaded driver file like brcm_dd_nic_11.7.4_windows_32-64.exe, and save the driver to the c:\.</p>
<h2 id="generate-the-pe-image-on-the-pe-node-w1"><a href="#TOC">Generate the PE image on the PE node w1</a></h2>
<p>On the w1, copy files out from d: to the desktop.&lt;bk&gt; Open a command line window and change directory to the desktop, run following command to generate the PE image.</p>
<pre><code># genimage.bat amd64</code></pre>
<p>Then you can find a directory was created at c:/WinPE_64/pxe, you need to copy all the directories/files in the c:/WinPE_64/pxe to the mn1:/tftpboot. Since you already has a samba directory exported out, it can be used to transport files back to management node.</p>
<h2 id="define-the-compute-node"><a href="#TOC">Define the compute node</a></h2>
<p>Define the compute node node1 on the management node.<br />Define the OS type and architecture for the node1:</p>
<pre><code># chdef node1 os=win2k8 arch=x86_64</code></pre>
<p>Add the default password for the new installed compute node:</p>
<pre><code># chtab key=system passwd.username=Administrator passwd.password=(password)</code></pre>
<p>Add the Windows license key for the node1:</p>
<pre><code># chtab node=node01 prodkey.product=win2k8 prodkey.key=XXXXX-XXXXX-XXXXX-XXXXX-XXXXX</code></pre>
<h2 id="install-the-windows-node"><a href="#TOC">Install the Windows Node</a></h2>
<pre><code>rinstall node01</code></pre>
<h2 id="reference"><a href="#TOC">Reference</a></h2>
<p>You can get more detail description about how to deploy a windows system: http://www-03.ibm.com/support/techdocs/atsmastr.nsf/WebIndex/W</p>
</body>
</html>
