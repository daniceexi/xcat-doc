<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#usage-scenarios">Usage Scenarios</a></li>
</ul>
</div>
<p><!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> Table of Contents</p>
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#usage-scenarios">Usage Scenarios</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<p>{{:Design Warning}}</p>
<h2 id="requirements"><a href="#TOC">Requirements</a></h2>
<p>We are starting to get requirements to manage from a single point sets of nodes that are more geographically or logically disperse than can be easily handled by service nodes. Some of the perceive requirements are:</p>
<ul>
<li>network connectivity between sites may be slow</li>
<li>different sites may be controlled by different organizations, making a single consolidated db undesirable</li>
</ul>
<h2 id="implementation"><a href="#TOC">Implementation</a></h2>
<p>We want to take a relatively simple approach to satisfying these requirements, based on our remote client support. Here are some ideas:</p>
<ul>
<li>On the global client (GC, the central point of control), it should have an ssl certificate (for xcatd) and an ssh key for each xcat MN it communicates with.
<ul>
<li>This would allow any xcat cmd to be run towards a single MN.</li>
<li>With a small modification to the p cmds (to not use xcatd to resolve the node range), all of them could work to the MNs (psh, prsync, etc.)</li>
</ul></li>
<li>The global client should have a list of the clusters that are being managed, i.e. a list of the MNs
<ul>
<li>This could either just be the list of ssl certificates, or a simpler list of hostnames in a config file</li>
<li>This would allow the p cmds above to support some simple groups like &quot;all&quot; in this context</li>
<li>We should also have a file on this machine like /etc/xCATGC that indicates this is a global client (similar to the /etc/xcATMN and /etc/xCATSN files). Then code like the p cmds can use this to know it should get node ranges from a different place.</li>
</ul></li>
<li>We should support running an xcat cmd to multiple MNs in one invocation.
<ul>
<li>This could be implemented as a new front end cmd like: xcatsh &lt;nr&gt; &lt;xcatcmd&gt;</li>
<li>Or existing the existing xcat cmd client scripts (xcatclient and xcatclientnnr) could be modified to automatically do this if it detects a special node range. But there are more client front ends than these, so they would all have to be modified.</li>
<li>In either case, the node range syntax supported should be something like: mn1%grp1,mn2%n1-n5</li>
<li>Then the output should be prefixed by the MN it came from so that xcoll can separate it</li>
</ul></li>
<li>Packaging:
<ul>
<li>A new meta pkg called xCATgc that requires xCAT-client</li>
</ul></li>
</ul>
<p>As an alternative implementation, we could install xcatd on the GC and have it dispatch cmds to the other MNs. In some ways, this would be a more elegant solution. But i'm concerned it would make xcatd even more complicated than it already is, which is a problem.</p>
<h2 id="usage-scenarios"><a href="#TOC">Usage Scenarios</a></h2>
<ul>
<li>rpower stat of all nodes in all clusters:
<ul>
<li>xcatsh 'all%all' rpower stat | xcoll</li>
</ul></li>
<li>Show the nodelist.status atttribute for all nodes in mn1 and mn2:
<ul>
<li>xcatsh mn1,mn2%all nodelist nodelist.status | xcoll</li>
</ul></li>
<li>Push content for the policy table to all clusters:
<ul>
<li>pscp /tmp/policy.csv all:/tmp/policy.csv</li>
<li>xcatsh all tabrestore /tmp/policy.csv</li>
</ul></li>
<li>Roll out a new stateless image to all clusters:
<ul>
<li>prsync /install/netboot/rhels6/x86_64/compute all:/install/netboot/rhels6/x86_64/</li>
<li>xcatsh all%compute nodeset netboot</li>
<li>xcatsh all%compute rpower boot</li>
</ul></li>
</ul>
</body>
</html>
